<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Why you need a builder to create your entities and models | imdhemy</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="Why you need a builder to create your entities and models" />
<meta name="author" content="Mohamad Eldhemy" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Static factories and constructors share a limitation; they do not scale well to large numbers of optional parameters. Consider the case of a class presenting a User on a social network platform. This class has only three required fields ($name, $email &amp; $password) and a bunch of optional fields with default values, for instance: ($address, $avatar, $gender, $emailVerifiedAt, etc…)." />
<meta property="og:description" content="Static factories and constructors share a limitation; they do not scale well to large numbers of optional parameters. Consider the case of a class presenting a User on a social network platform. This class has only three required fields ($name, $email &amp; $password) and a bunch of optional fields with default values, for instance: ($address, $avatar, $gender, $emailVerifiedAt, etc…)." />
<link rel="canonical" href="https://imdhemy.com/blog/php/why-you-need-a-builder-to-create-your-entities-and-models.html" />
<meta property="og:url" content="https://imdhemy.com/blog/php/why-you-need-a-builder-to-create-your-entities-and-models.html" />
<meta property="og:site_name" content="imdhemy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-06-02T00:01:38+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Why you need a builder to create your entities and models" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Mohamad Eldhemy"},"description":"Static factories and constructors share a limitation; they do not scale well to large numbers of optional parameters. Consider the case of a class presenting a User on a social network platform. This class has only three required fields ($name, $email &amp; $password) and a bunch of optional fields with default values, for instance: ($address, $avatar, $gender, $emailVerifiedAt, etc…).","url":"https://imdhemy.com/blog/php/why-you-need-a-builder-to-create-your-entities-and-models.html","@type":"BlogPosting","headline":"Why you need a builder to create your entities and models","dateModified":"2021-06-02T00:01:38+00:00","datePublished":"2021-06-02T00:01:38+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://imdhemy.com/blog/php/why-you-need-a-builder-to-create-your-entities-and-models.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css?t=2022-05-30-05-48"><link type="application/atom+xml" rel="alternate" href="https://imdhemy.com/feed.xml" title="imdhemy" /></head>
<body><div class="container mx-auto pt-7 pb-7">
    <header class="flex flex-row">
        <!-- Brand start-->
        <div class="p-5">
            <a href="/" class="flex justify-start items-center mr-3 hover:no-underline block">
                <img class="w-5 h-5 lg:w-10 lg:h-10" src="/logo.png" alt="imdhemy">
                <span class="font-bold text-xl lg:text-4xl text-black font-sans">imdhemy</span>
            </a>
        </div>
        <!-- Brand End -->

        <!-- Mobile Navigation Start -->
        <div class="flex-auto flex justify-end p-5 lg:hidden">
            <button id="nav-controller" class="focus:outline-none block">
                <ion-icon class="text-4xl w-10 h-10 p-0 m-0" name="menu-outline"></ion-icon>
            </button>
            <div id="mobile-nav-menu" class="fixed bg-white right-0 bottom-0 left-0 hidden">
                <div class="flex h-full justify-center p-10">
                    <ul class="flex flex-col justify-center text-left p-0 m-0">
                        
                        
                        <li class="text-3xl font-light mobile-nav-link-item"><a href="/">Home</a></li>
                        
                        
                        
                        <li class="text-3xl font-light mobile-nav-link-item"><a href="/blog">Blog</a></li>
                        
                        
                        
                        <li class="text-3xl font-light mobile-nav-link-item"><a href="/about">About</a></li>
                        
                        
                    </ul>
                </div>
            </div>
        </div>
        <!-- Mobile Navigation End -->

        <!-- Desktop Navigation Start -->
        <div class="hidden lg:block flex-auto flex p-5">
            
            
            <ul class="flex justify-end text-left p-0 m-0">
                
                
                
                
                <li class="text-xl font-light mobile-nav-link-item nav-item"><a href="/">Home</a></li>
                
                
                
                
                
                
                <li class="text-xl font-light mobile-nav-link-item nav-item nav-item-active"><a href="/blog">Blog</a></li>
                
                
                
                
                
                
                <li class="text-xl font-light mobile-nav-link-item nav-item"><a href="/about">About</a></li>
                
                
                
            </ul>
        </div>
        <!-- Desktop Navigation End -->
    </header>
</div>
<main class="container mx-auto lg:w-2/3" aria-label="Content">
    <header class="container mx-auto p-5 text-center">
    <h1 class="post-title p-name" itemprop="name headline">Why you need a builder to create your entities and models</h1>
    <p class="post-meta">
        <time class="dt-published" datetime="2021-06-02T00:01:38+00:00" itemprop="datePublished">Jun 2, 2021
        </time>
        
        • <span>php</span>
        
    </p>
</header>

<article class="bg-white rounded-lg filter drop-shadow-md lg:ml-0 lg:mr-0 ml-5 mr-5 mb-20" itemscope itemtype="http://schema.org/BlogPosting">

    <div class="p-5 post-content" itemprop="articleBody">
        <p><a href="/blog/php/three-advantages-of-using-static-factory-methods-in-php.html">Static factories</a> and constructors share a limitation; they do not scale well to large numbers of optional parameters. Consider the case of a class presenting a <strong>User</strong> on a social network platform. This class has only three required fields (<code class="language-plaintext highlighter-rouge">$name</code>, <code class="language-plaintext highlighter-rouge">$email</code> &amp; <code class="language-plaintext highlighter-rouge">$password</code>) and a bunch of optional fields with default values, for instance: (<code class="language-plaintext highlighter-rouge">$address</code>, <code class="language-plaintext highlighter-rouge">$avatar</code>, <code class="language-plaintext highlighter-rouge">$gender</code>, <code class="language-plaintext highlighter-rouge">$emailVerifiedAt</code>, etc…).</p>

<p><em><strong>As a side note:</strong> this is not my preferred way to design a user entity, but this is only here for purpose of clarifying the situation of having a long parameter list.</em></p>

<p>Starting from here, I’ll explore the practices I previously did or noticed in other developers’ code.</p>

<h2 id="the-laravel-models-taste">The Laravel models taste</h2>
<p>Laravel models provide two methods to create a model instance, the most popular <code class="language-plaintext highlighter-rouge">create</code> method and the less popular <code class="language-plaintext highlighter-rouge">make</code> method. Both methods are not implemented in the base <code class="language-plaintext highlighter-rouge">Model</code> class. But Laravel defines a <code class="language-plaintext highlighter-rouge">__call()</code> and <code class="language-plaintext highlighter-rouge">__callStatic()</code> methods, it goes handled through them. <a href="https://github.com/laravel/framework/blob/8.x/src/Illuminate/Database/Eloquent/Model.php#L1952">Those methods forward the call to a query builder!</a></p>

<p>Finally, we have a model class that has no properties, a parameterless constructor! Everything is injected magically into the class.</p>

<p>The Model class looks like the following snippet:</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">User</span> <span class="kd">extends</span> <span class="nc">Model</span>
<span class="p">{</span>
    <span class="c1">//</span>
<span class="p">}</span>
</code></pre></div></div>
<p>The client code be like:</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$user</span> <span class="o">=</span> <span class="nc">User</span><span class="o">::</span><span class="nf">create</span><span class="p">([</span>
    <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'John Doe'</span><span class="p">,</span>
    <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="s1">'john@example.com'</span><span class="p">,</span>
    <span class="s1">'password'</span> <span class="o">=&gt;</span> <span class="nv">$passwordHash</span>
<span class="p">]);</span>
</code></pre></div></div>
<p><strong>IMHO, this is not so good due to the following reasons!</strong></p>

<ul>
  <li>Sooner or later, you’ll end up with a model with <strong>an invalid state</strong> or any <a href="https://www.php.net/manual/en/language.oop5.overloading.php#119407">kind of unexpected behavior</a>.</li>
  <li>The model <strong>has no properties</strong> and even more if you defined the properties to solve this problem the code will break!</li>
  <li>All properties are treated as public properties which means <strong>no encapsulation</strong> at all!</li>
  <li>Your <strong>IDE doesn’t understand</strong> that!</li>
  <li>You need to <strong>check your schema</strong> in a repeated manner to remember the properties and their types.</li>
  <li>Feel free to add more problems to this list…</li>
</ul>

<h2 id="a-factory-that-accepts-an-array-of-attributes">A factory that accepts an array of attributes</h2>
<p>Another technique I noticed some developers use is to provide a factory that receives an array of attributes, then starts a series of <code class="language-plaintext highlighter-rouge">isset</code> calls accompanied by a call to a setter method!</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">User</span> <span class="kd">extends</span> <span class="nc">Entity</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="kt">string</span> <span class="nv">$name</span><span class="p">;</span>
    <span class="k">private</span> <span class="kt">string</span> <span class="nv">$email</span><span class="p">;</span>
    
    <span class="c1">// and so on ...</span>
    
    <span class="k">public</span> <span class="k">function</span> <span class="n">setName</span><span class="p">(</span><span class="kt">string</span> <span class="nv">$name</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">=</span> <span class="nv">$name</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">public</span> <span class="k">function</span> <span class="n">setEmail</span><span class="p">(</span><span class="kt">string</span> <span class="nv">$email</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">email</span> <span class="o">=</span> <span class="nv">$email</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="c1">// ... </span>
    
    <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="n">create</span><span class="p">(</span><span class="kt">array</span> <span class="nv">$attributes</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">User</span><span class="p">();</span>
        
        <span class="k">if</span><span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$attributes</span><span class="p">[</span><span class="s1">'name'</span><span class="p">]))</span> <span class="nv">$obj</span><span class="o">-&gt;</span><span class="nf">setName</span><span class="p">(</span><span class="nv">$attributes</span><span class="p">[</span><span class="s1">'name'</span><span class="p">]);</span>
        <span class="k">if</span><span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$attributes</span><span class="p">[</span><span class="s1">'email'</span><span class="p">]))</span> <span class="nv">$obj</span><span class="o">-&gt;</span><span class="nf">setEmail</span><span class="p">(</span><span class="nv">$attributes</span><span class="p">[</span><span class="s1">'email'</span><span class="p">]);</span>
        <span class="c1">// ... Pew Pew Pew</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Just imagine repeating this to cover all the class properties!</p>

<ul>
  <li>With <strong>parameterless constructors</strong>, you need to handle the required params yourself!</li>
  <li>Again, have entities with <strong>an invalid state</strong>!</li>
  <li><strong>Hard to read</strong>, hard to maintain code.</li>
  <li>Your <strong>IDE doesn’t understand</strong> that!</li>
</ul>

<h2 id="telescoping-constructor">Telescoping constructor</h2>
<p>Telescoping constructor means to provide a constructor with only the required parameters, another with a single optional parameter, a third with two optional parameters, and so on.</p>

<p>Since PHP doesn’t allow constructor overloading, PHP developers started to provide a constructor with a full list of properties starting with the required params.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">User</span>
<span class="p">{</span>
    <span class="c1">// .. </span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">(</span><span class="kt">string</span> <span class="nv">$name</span><span class="p">,</span> <span class="kt">string</span> <span class="nv">$email</span><span class="p">,</span> <span class="kt">string</span> <span class="nv">$password</span><span class="p">,</span> <span class="kt">int</span> <span class="nv">$foo</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="kt">int</span> <span class="nv">$bar</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="kt">?Address</span> <span class="nv">$address</span> <span class="o">=</span> <span class="kc">null</span><span class="p">,</span> <span class="kt">?File</span> <span class="nv">$avatar</span><span class="o">=</span><span class="kc">null</span><span class="p">,</span> <span class="kt">?DateTime</span> <span class="nv">$createdAt</span><span class="o">=</span><span class="kc">null</span><span class="p">)</span>
    <span class="p">{</span>
       <span class="c1">// ..</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<p>When you want to create an instance, you can pass the shortest list of parameters you want to set. Typically, this constructor invocation will require many parameters that you don’t want to set, but you are forced to pass a value for them.</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$user</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">User</span><span class="p">(</span><span class="s1">'John Doe'</span><span class="p">,</span> <span class="s1">'john@example.com'</span><span class="p">,</span> <span class="nv">$passwordHash</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nv">$avatar</span><span class="p">);</span>
</code></pre></div></div>
<p>In this case, we’re forced to pass <code class="language-plaintext highlighter-rouge">5, 12, null</code> values which are the default values since the avatar comes after them in order!</p>

<p>The telescoping constructor work, but it is hard to write client code when there are many parameters, and harder still to read it. The reader is left wondering what all those values mean and must carefully count parameters to find out. Umm, what if he swapped the <code class="language-plaintext highlighter-rouge">12</code> and <code class="language-plaintext highlighter-rouge">50</code> since having the same data type, the code won’t break, but it’s an invalid state again!</p>

<h2 id="fluent-setters">Fluent Setters</h2>
<p>Fluent Setters is the PHP way to imitate the <a href="https://en.wikipedia.org/wiki/JavaBeans">JavaBeans</a> Pattern In which you call a parameterless constructor followed by call to setter methods. It’s called fluent because all setter methods return the object instance allowing you to call them in chains.</p>

<p>This pattern has none of the disadvantages of the telescoping constructor pattern. It makes it easy to create instances, and easy to read the resulting code:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$user</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">User</span><span class="p">();</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="nf">setName</span><span class="p">(</span><span class="s1">'John Doe'</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="nf">setEmail</span><span class="p">(</span><span class="s1">'john@example.com'</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="nf">setPassword</span><span class="p">(</span><span class="nv">$passwordHash</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="nf">setAddress</span><span class="p">(</span><span class="s1">'Via Lactea'</span><span class="p">);</span>
</code></pre></div></div>

<p>Unfortunately, the Fluent setters pattern has the following disadvantages:</p>
<ul>
  <li>A class with a parameterless constructor is subject to being instantiated in <strong>an invalid state</strong>.</li>
  <li>Having to create setters for every property leads to an immense quantity of <strong>boilerplate code</strong>.</li>
</ul>

<h2 id="using-a-builder-is-a-good-solution">Using a builder is a good solution!</h2>
<p>We can use a form of the <a href="https://refactoring.guru/design-patterns/builder">Builder Pattern</a> which combines the safety of the telescoping constructors and the readability of the fluent setters. Instead of creating the desired object directly, the client calls a static factory method with all the required parameters and gets an object of the builder class which provides setter-like methods for other optional methods. Finally, the client calls a parameterless <code class="language-plaintext highlighter-rouge">build</code> method to get an instance of the required class. Let me show you an example:</p>

<p><strong>I prefer to start with The Client Code:</strong></p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cd">/**
 * @test
 */</span>
<span class="k">public</span> <span class="k">function</span> <span class="n">test_builder_can_create_user</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nv">$user</span> <span class="o">=</span> <span class="nc">User</span><span class="o">::</span><span class="nf">builder</span><span class="p">()</span>
        <span class="o">-&gt;</span><span class="nf">name</span><span class="p">(</span><span class="s1">'John Doe'</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="nf">email</span><span class="p">(</span><span class="s1">'john@example.com'</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="nf">address</span><span class="p">(</span><span class="s1">'Via Lactea'</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="nf">build</span><span class="p">();</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">assertInstanceOf</span><span class="p">(</span><span class="nc">User</span><span class="o">::</span><span class="n">class</span><span class="p">,</span> <span class="nv">$user</span><span class="p">);</span>
    <span class="c1">// More assertions...</span>
<span class="p">}</span>
</code></pre></div></div>
<p><strong>Then the Entity class:</strong></p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">User</span>
<span class="p">{</span>
    <span class="cd">/**
     * @var string
     */</span>
    <span class="k">private</span> <span class="kt">string</span> <span class="nv">$name</span><span class="p">;</span>

    <span class="cd">/**
     * @var string
     */</span>
    <span class="k">private</span> <span class="kt">string</span> <span class="nv">$email</span><span class="p">;</span>

    <span class="cd">/**
     * @var string
     */</span>
    <span class="k">private</span> <span class="kt">string</span> <span class="nv">$address</span><span class="p">;</span>
    
    <span class="c1">//More attributes...</span>
    <span class="c1">//...</span>

    <span class="cd">/**
     * You can use one of the following options for the constructor:
     * 1. Parameterless constructor &amp; add a static factory method that accepts the UserBuilder as a param
     * 2. A constructor that accepts the UserBuilder as a param.
     * User constructor.
     * @param \App\UserBuilder $builder
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">(</span><span class="kt">UserBuilder</span> <span class="nv">$builder</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="nf">getName</span><span class="p">();</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">email</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="nf">getEmail</span><span class="p">();</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">address</span> <span class="o">=</span> <span class="nv">$builder</span><span class="o">-&gt;</span><span class="nf">getAddress</span><span class="p">();</span>
        <span class="c1">// .. Set other attributes</span>
    <span class="p">}</span>

    <span class="cd">/**
     * @return \App\UserBuilder
     */</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="n">builder</span><span class="p">():</span> <span class="kt">UserBuilder</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">UserBuilder</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="cd">/**
     * @return string
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">getName</span><span class="p">():</span> <span class="kt">string</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cd">/**
     * @param string $name
     * @return User
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">setName</span><span class="p">(</span><span class="kt">string</span> <span class="nv">$name</span><span class="p">):</span> <span class="kt">User</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">=</span> <span class="nv">$name</span><span class="p">;</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cd">/**
     * @return string
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">getEmail</span><span class="p">():</span> <span class="kt">string</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">email</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cd">/**
     * @param string $email
     * @return User
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">setEmail</span><span class="p">(</span><span class="kt">string</span> <span class="nv">$email</span><span class="p">):</span> <span class="kt">User</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">email</span> <span class="o">=</span> <span class="nv">$email</span><span class="p">;</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cd">/**
     * @return string
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">getAddress</span><span class="p">():</span> <span class="kt">string</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">address</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cd">/**
     * @param string $address
     * @return User
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">setAddress</span><span class="p">(</span><span class="kt">string</span> <span class="nv">$address</span><span class="p">):</span> <span class="kt">User</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">address</span> <span class="o">=</span> <span class="nv">$address</span><span class="p">;</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<p><strong>Finally, the Builder class:</strong></p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">UserBuilder</span>
<span class="p">{</span>
    <span class="cd">/**
     * @var string
     */</span>
    <span class="k">private</span> <span class="kt">string</span> <span class="nv">$name</span><span class="p">;</span>

    <span class="cd">/**
     * @var string
     */</span>
    <span class="k">private</span> <span class="kt">string</span> <span class="nv">$email</span><span class="p">;</span>

    <span class="cd">/**
     * @var string
     */</span>
    <span class="k">private</span> <span class="kt">string</span> <span class="nv">$address</span><span class="p">;</span>

    <span class="cd">/**
     * @param string $name
     * @return $this
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">name</span><span class="p">(</span><span class="kt">string</span> <span class="nv">$name</span><span class="p">):</span> <span class="kt">self</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">=</span> <span class="nv">$name</span><span class="p">;</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cd">/**
     * @param string $email
     * @return $this
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">email</span><span class="p">(</span><span class="kt">string</span> <span class="nv">$email</span><span class="p">):</span> <span class="kt">self</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">email</span> <span class="o">=</span> <span class="nv">$email</span><span class="p">;</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cd">/**
     * @param string $address
     * @return $this
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">address</span><span class="p">(</span><span class="kt">string</span> <span class="nv">$address</span><span class="p">):</span> <span class="kt">self</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">address</span> <span class="o">=</span> <span class="nv">$address</span><span class="p">;</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cd">/**
     * @return string
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">getName</span><span class="p">():</span> <span class="kt">string</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cd">/**
     * @return string
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">getEmail</span><span class="p">():</span> <span class="kt">string</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">email</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cd">/**
     * @return string
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">getAddress</span><span class="p">():</span> <span class="kt">string</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">address</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cd">/**
     * @return \App\User
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">build</span><span class="p">():</span> <span class="kt">User</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">User</span><span class="p">(</span><span class="nv">$this</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Note:</strong> The previous example uses a parameterless <code class="language-plaintext highlighter-rouge">UserBuilder</code> constructor, but you should add the required attributes as parameters to confirm creating an object in a valid state.</p>

<h2 id="summary">Summary</h2>
<p>In summary, the Builder pattern is a good choice when designing classes whose constructors or static factories would have more than a handful of parameters, especially if much of the parameters are optional or of identical type. Client code is much easier to read and write with builders than with telescoping constructors, and builders are much safer than the Fluent setters.</p>

    </div><a class="u-url" href="/blog/php/why-you-need-a-builder-to-create-your-entities-and-models.html" hidden></a>

    <div class="lg:flex bg-sky-100 border-t-2 border-sky-300 justify-between p-4 text-lg rounded-br-lg rounded-bl-lg">
        <div class="flex flex-col justify-center mb-4 lg:mb-0">
            
           <div class="text-center">
               <p class="uppercase">Previous Post</p>
               <a href="/blog/php/three-advantages-of-using-static-factory-methods-in-php.html">&larr;Three advantages of using static factory methods in PHP</a>
           </div>
            
        </div>

        <div class="flex flex-col justify-center">
            
            <div class="text-center">
                <p class="uppercase">Next Post</p>
                <a class="next" href="/blog/php/how-to-test-elasticsearch-in-php-apps.html">How to test Elasticsearch in PHP applications&rarr;</a>
            </div>
            
        </div>

    </div>
</article>

</main><footer class="bg-white">
    <div class="container mx-auto lg:p-0 p-5">
        <div class="flex flex-col justify-center pt-10 pb-10 text-lg">
            <div class="flex-1 text-center">
                <p>Let's get together</p>
                <ul class="footer-social-links p-0 m-0">
                    
                    <li class="inline"><a href="https://twitter.com/imdhemy">Twitter</a></li>
                    
                    <li class="inline"><a href="https://github.com/imdhemy">Github</a></li>
                    
                    <li class="inline"><a href="https://linkedin.com/in/imdhemy">Linkedin</a></li>
                    
                </ul>
            </div>

            <div class="flex-1 text-center mt-10">
                <p>&copy; 2021 - 2022 imdhemy.com</p>
            </div>
        </div>
    </div>
</footer>

<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"></script>

<script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
<script src="https://imdhemy.com/assets/js/script.js?v=2022-05-30-05-48"></script>
</body>

</html>
