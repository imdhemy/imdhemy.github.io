<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>What is a unit test</title>
    <meta name="description"
          content="When I started writing this article few months ago, I got blocked by the idea of I’m going to write about something that everyone knows about and everyone ca...">
    <link rel="canonical" href="https://imdhemy.com/blog/testing/what-is-a-unit-test.html">
    <link rel="stylesheet" href="/assets/css/main.css?v=1.0.0">
    
    <link rel="icon" type="image/png" href="/assets/theme/favicon.png">
    
    

    
    <!-- Facebook Meta Tags -->
<meta property="og:title" content="What is a unit test">
<meta property="og:type" content="article">
<meta property="og:image" content="https://imdhemy.com">
<meta property="og:url" content="https://imdhemy.com/blog/testing/what-is-a-unit-test.html">
<meta property="og:description"
      content="When I started writing this article few months ago, I got blocked by the idea of I’m going to write about something that everyone knows about and everyone ca...">
<meta property="og:site_name" content="Imdhemy">

<!-- Twitter Meta Tags -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="What is a unit test">
<meta name="twitter:description"
      content="When I started writing this article few months ago, I got blocked by the idea of I’m going to write about something that everyone knows about and everyone ca...">
<meta name="twitter:image" content="https://imdhemy.com">


    

</head>
<body class="min-h-screen">
<div class="min-h-screen">
    <header class="relative" id="main-header">
    <div class="container mx-auto">
        <div class="flex py-6 lg:py-14 p-5 lg:px-0">
            <!-- begin logo -->
            <div class="flex-auto">
                <div>
                    <a href="/" class="text-gray-900 text-3xl font-bold">
                        Imdhemy
                    </a>
                </div>
            </div>
            <!-- end logo -->
            <!-- begin right part -->
            <div class="flex-auto">
                <div class="flex justify-end lg:hidden">
                    <button type="button" class="menu-toggle" data-target="#mobile-nav">
                        <ion-icon name="menu-outline"></ion-icon>
                    </button>
                </div>

                <div class="hidden lg:flex justify-end">
                    <ul class="flex items-center">
                        
                        <li class="ml-10">
                            <a href="/"
                               class="text-base font-semibold p-2 text-gray-900 ease-linear hover:text-blue-600 active:text-blue-600">
                                Home
                            </a>
                        </li>
                        
                        <li class="ml-10">
                            <a href="/blog"
                               class="text-base font-semibold p-2 text-gray-900 ease-linear hover:text-blue-600 active:text-blue-600">
                                Blog
                            </a>
                        </li>
                        
                        <li class="ml-10">
                            <a href="/about"
                               class="text-base font-semibold p-2 text-gray-900 ease-linear hover:text-blue-600 active:text-blue-600">
                                About
                            </a>
                        </li>
                        
                    </ul>
                </div>
                <!-- end right part -->
            </div>
            <!-- begin mobile nav -->
            <nav id="mobile-nav"
                 class="menu -z-10 opacity-0 absolute top-32 right-6 block min-w-fit w-40 bg-white p-5 rounded-md shadow-md ease-linear">
                <div class="ml-auto">
                    <ul class="p-0 m-0 flex-column items-center">
                        
                        <li class="block flex-1 w-full m-0">
                            <a href="/"
                               class="block text-right text-base font-semibold p-2 text-gray-900 ease-linear hover:text-blue-600 active:text-blue-600">
                                Home
                            </a>
                        </li>
                        
                        <li class="block flex-1 w-full m-0">
                            <a href="/blog"
                               class="block text-right text-base font-semibold p-2 text-gray-900 ease-linear hover:text-blue-600 active:text-blue-600">
                                Blog
                            </a>
                        </li>
                        
                        <li class="block flex-1 w-full m-0">
                            <a href="/about"
                               class="block text-right text-base font-semibold p-2 text-gray-900 ease-linear hover:text-blue-600 active:text-blue-600">
                                About
                            </a>
                        </li>
                        
                    </ul>
                </div>
            </nav>
            <!-- end mobile nav -->
        </div>
    </div>
</header>

    <main>
        <div class="max-w-screen-lg mx-auto bg-white p-5">
    <h1 class="font-black font-sans text-2xl lg:text-7xl post-title">What is a unit test</h1>
</div>

<div class="max-w-screen-md mx-auto bg-white p-5">
    <div class="flex justify-between flex-wrap my-2">
        <div class="flex items-center mr-8">
            <img src="/theme/images/avatar.jpeg" alt=""
                 class="rounded-full w-10 h-10 mr-3 block"/>
            <div>
                <p class="text-gray-700 text-sm font-bold">Dhemy</p>
                <p class="text-gray-500 text-xs">
                    August 13, 2022 - 4 min read
                </p>
            </div>
        </div>
    </div>

    <div>
        
        <div class="flex mb-5">
    
</div>

    </div>

    
</div>


<div class="max-w-screen-md mx-auto bg-white p-5 text-xl content">
    <p>When I started writing this article few months ago, I got blocked by the 
idea of I’m going to write about something that everyone knows about and 
everyone can google the topic and found a ton of articles about the same 
basic topic. 
Should I publish such an article? As I said, I got blocked by this idea, the 
thing that stopped me from completing the series I started about <a href="/blog/testing/we-need-more-tests">testing</a>.</p>

<p>Finally, I decided to write this article to refer to it in case I 
needed in next articles, at least it will be an internal reference.</p>

<h2 id="what-is-a-unit-test">What is a unit test?</h2>
<p>You should already know about test automation. Given a piece of code, you 
can write another piece of code that verifies the behavior of the first. The 
second piece of code is called a unit test.</p>

<div class="tip">
    <p>A unit test should verify a small piece of code in isolation quickly.</p>
</div>

<p>As you can see, a unit test has three characteristics:</p>
<ul>
  <li>Verifies a small piece of code.</li>
  <li>Is quick to run.</li>
  <li>Works in isolation.</li>
</ul>

<p>A small piece of code could be a function, a class, a method, or whatever 
you can call a unit. If your test suite’s execution time is good enough to 
you, it means tests are quick enough.</p>

<div class="tip">
A <i>unit</i> in unit testing is a unit of behaviour, not a unit of 
<i>code</i>. This behaviour can span across as many as several classes or as 
a single method, but it should have a single entry point to trigger the behaviour.
</div>

<p>No doubt, the first two characteristics are non-controversial. The third one, isolation, is 
controversial. When it comes to isolation, there are two takes, the Mockist 
take and the Classicist take.</p>

<h2 id="mockist-take-vs-classicist-take">Mockist take vs Classicist take</h2>
<p>These two tribes are commonly referred to as the Detroit School of TDD 
(Classicist) and the London School of TDD (Mockist). A key difference 
between them is how they treat the dependencies of the code under test.</p>

<p>For the Mockist take, if a class has a dependency on another class or 
service, it is mocked or doubled. This means that isolation here is code 
isolation. But for the Classicist take, if a class has a dependency, the 
dependency should be used as it. It is not the code that needs to be 
isolated during testing. Instead, unit tests themselves should run in 
isolation from each other.</p>

<p>I believe that the style of mocking everything results in a fragile, hard to 
refactor code base. It does not reflect the real scenario, besides, it 
burdens your shoulders with maintaining the mocks when the real source code
changes. I’m not completely opposed to mocking, but we should mock to our 
advantage, wherever it makes our tests more manageable.</p>

<p>Another problem with the Mockist take is detecting changes in other services 
they are integrated with. For example, if a dependency behaviour changed, 
the mockist test will not detect it, it depends on a non-updated mock. Tests 
should be sensitive to the behavior changes and insensitive to the 
structural changes.</p>

<blockquote>
  <p>If I care about the order of operations, I’ve designed the system wrong. — <strong>Kent Beck (the Detroit School).</strong></p>
</blockquote>

<blockquote>
  <p>If I have an object that has behaviour, and I’m doing “Tell, Don’t Ask” then I can only test interactions. — <strong>Steve Freeman (the London School)</strong></p>
</blockquote>

<h2 id="when-to-mock-vs-when-to-use-real-dependencies">When to mock vs when to use real dependencies</h2>

<p>Hopefully, it’s clear now that I prefer the Classicist take. In the 
classicist take, it’s not the code that needs to be tested in an isolated 
manner. Instead, the unit tests themselves should be run in isolation from 
each other. The classes under test reside in the memory of the test runner, 
so that they can interact with each other without affecting the test results 
either you run the tests in parallel or in sequence.</p>

<p>There is a problem, Okay, they reside in the memory and not affecting 
each other, but what about the shared states? For example, the database and 
file system. Of course, changes in the database will affect the test results.
For instance, one test could create a record in the database, and the other 
test could delete the record as a part of its setup. If you run them in 
parallel, the first test will fail, not because the code is broken, but 
because it is not isolated.</p>

<p>Let’s look at three different types of dependencies: the <strong>shared</strong>, the <strong>private</strong> 
and the <strong>out-of-process</strong>. The shared dependencies are the ones that are 
shared across the test suite, for example, a static field, a database record,
and the file system.</p>

<p>The private dependencies are the ones that are not shared at all, for 
example a private field, or a function parameter.</p>

<p>The out-of-process dependencies are the ones that are the ones that run 
outside the application’s execution context. For example an external API.</p>

<p>Given the above, Classist take still can use mocks and test doubles, but 
only do that for the shared dependencies, or the out-of-process dependencies 
in case you need to test a specific behavior of the external service.</p>

<h2 id="conclusion">Conclusion</h2>
<p>Let’s conclude them in <strong>triplets</strong>:</p>

<p><strong>A unit test has three characteristics:</strong></p>
<ul>
  <li>Verifies a small piece of code.</li>
  <li>Is quick to run.</li>
  <li>Works in isolation.</li>
</ul>

<p><strong>There are three types of dependencies:</strong></p>
<ul>
  <li>Shared.</li>
  <li>Private.</li>
  <li>Out-of-process.</li>
</ul>

<p><strong>There are three schools of TDD:</strong></p>
<ul>
  <li>The Detroit School.</li>
  <li>The London School.</li>
  <li>The one that your manager told you to use.</li>
</ul>

<p><strong>There are three reasons to use mocks:</strong></p>
<ul>
  <li>Replacing the shared dependencies.</li>
  <li>The non-deterministic behavior of the out-of-process dependencies.</li>
  <li>To make tests faster. (Replacing DB calls for example.)</li>
</ul>

</div>


    </main>
    <section class="sticky top-[100vh]">
    <div class="p-10">
        <div class="max-w-screen-md mx-auto">
            <p class="text-center">
                <!-- 2001 - jekyll current year -->
                &copy; 2021 - 2024 . imdhemy.com Published by Jekyll, hosted on GitHub Pages.
            </p>
        </div>
    </div>
</section>

</div>


<!-- Ion icons -->
<script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

<!-- Main JS file -->
<script src="/assets/js/dist/main.js?v=1.0.0"></script>
</body>
</html>
